<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jose Storopoli" />
  <meta name="author" content="Rik Huijzer" />
  <meta name="author" content="Lazaro Alonso" />
  <title>DataFrames.jl - Julia Data Science</title>
  <link rel="shortcut icon" type="image/png" href="/favicon.png"/>
  <link rel="stylesheet" href="/style.css"/>
    <script src="/mousetrap.min.js"></script>
    <style>
  @font-face {
    font-family: JuliaMono-Regular;
    src: url("/JuliaMono-Regular.woff2");
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <link rel="stylesheet" href="/github.min.css">
<script src="/highlight.min.js"></script>
<script src="/julia.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
        if (!el.classList.contains('output')) {
            hljs.highlightElement(el);
        }
    });
});
</script>
 
</head>
<body>
<script>
function click_next() {
  var next = document.getElementById('nav-next');
  next.firstElementChild.nextElementSibling.click();
}
function click_prev() {
  var prev = document.getElementById('nav-prev');
  prev.firstElementChild.click();
}
Mousetrap.bind('right', click_next);
Mousetrap.bind('h', click_prev);
Mousetrap.bind('left', click_prev);
Mousetrap.bind('l', click_next);
</script>

<div class="books-container">
<aside class="books-menu">
<input type="checkbox" id="menu">
<label for="menu">☰</label>
<div class="books-title">
<a href="/">Julia Data Science</a>
</div><br />
<span class="books-subtitle">

</span>
<div class="books-menu-content">
<li><a class="menu-level-1" href="/preface"><b>1</b> Preface</a></li>
<li><a class="menu-level-2" href="/why_data_science"><b>1.1</b> What is Data Science?</a></li>
<li><a class="menu-level-2" href="/engineering"><b>1.2</b> Software Engineering</a></li>
<li><a class="menu-level-2" href="/acknowledgements"><b>1.3</b> Acknowledgements</a></li>
<li><a class="menu-level-1" href="/why_julia"><b>2</b> Why Julia?</a></li>
<li><a class="menu-level-2" href="/non-programmers"><b>2.1</b> For Non-Programmers</a></li>
<li><a class="menu-level-2" href="/programmers"><b>2.2</b> For Programmers</a></li>
<li><a class="menu-level-2" href="/julia_accomplish"><b>2.3</b> What Julia Aims to Accom..</a></li>
<li><a class="menu-level-2" href="/julia_wild"><b>2.4</b> Julia in the Wild</a></li>
<li><a class="menu-level-1" href="/julia_basics"><b>3</b> Julia Basics</a></li>
<li><a class="menu-level-2" href="/ide"><b>3.1</b> Development Environments</a></li>
<li><a class="menu-level-2" href="/syntax"><b>3.2</b> Language Syntax</a></li>
<li><a class="menu-level-2" href="/data_structures"><b>3.3</b> Native Data Structures</a></li>
<li><a class="menu-level-2" href="/filesystem"><b>3.4</b> Filesystem</a></li>
<li><a class="menu-level-2" href="/standardlibrary"><b>3.5</b> Julia Standard Library</a></li>
<li><a class="menu-level-1" href="/dataframes"><b>4</b> DataFrames.jl</a></li>
<li><a class="menu-level-2" href="/load_save"><b>4.1</b> Load and Save Files</a></li>
<li><a class="menu-level-2" href="/index-and-summarize"><b>4.2</b> Index and Summarize</a></li>
<li><a class="menu-level-2" href="/filter_subset"><b>4.3</b> Filter and Subset</a></li>
<li><a class="menu-level-2" href="/select"><b>4.4</b> Select</a></li>
<li><a class="menu-level-2" href="/types"><b>4.5</b> Types and Categorical Da..</a></li>
<li><a class="menu-level-2" href="/join"><b>4.6</b> Join</a></li>
<li><a class="menu-level-2" href="/transform"><b>4.7</b> Variable Transformations</a></li>
<li><a class="menu-level-2" href="/groupby_combine"><b>4.8</b> Groupby and Combine</a></li>
<li><a class="menu-level-2" href="/missing"><b>4.9</b> Missing Data</a></li>
<li><a class="menu-level-2" href="/df_performance"><b>4.10</b> Performance</a></li>
<li><a class="menu-level-1" href="/dataframesmeta"><b>5</b> DataFramesMeta.jl</a></li>
<li><a class="menu-level-2" href="/dataframesmeta_macros"><b>5.1</b> Macros</a></li>
<li><a class="menu-level-2" href="/dataframesmeta_select"><b>5.2</b> Column Selection</a></li>
<li><a class="menu-level-2" href="/dataframesmeta_transform"><b>5.3</b> Column Transformation</a></li>
<li><a class="menu-level-2" href="/dataframesmeta_subset"><b>5.4</b> Row Selection</a></li>
<li><a class="menu-level-2" href="/dataframesmeta_orderby"><b>5.5</b> Row Sorting</a></li>
<li><a class="menu-level-2" href="/dataframesmeta_combine"><b>5.6</b> Data Summaries</a></li>
<li><a class="menu-level-2" href="/dataframesmeta_chain"><b>5.7</b> Piping Operations</a></li>
<li><a class="menu-level-1" href="/DataVisualizationMakie"><b>6</b> Data Visualization with Ma..</a></li>
<li><a class="menu-level-2" href="/cairomakie"><b>6.1</b> CairoMakie.jl</a></li>
<li><a class="menu-level-2" href="/datavisMakie_attributes"><b>6.2</b> Attributes</a></li>
<li><a class="menu-level-2" href="/datavisMakie_create_Figure"><b>6.3</b> Create Plot Figure</a></li>
<li><a class="menu-level-2" href="/makie_cheat_sheets"><b>6.4</b> Cheat Sheets</a></li>
<li><a class="menu-level-2" href="/themes"><b>6.5</b> Themes</a></li>
<li><a class="menu-level-2" href="/using-latexstrings.jl"><b>6.6</b> Using LaTeXStrings.jl</a></li>
<li><a class="menu-level-2" href="/makie_colors"><b>6.7</b> Colors and Colormaps</a></li>
<li><a class="menu-level-2" href="/makie_layouts"><b>6.8</b> Layouts</a></li>
<li><a class="menu-level-2" href="/glmakie"><b>6.9</b> GLMakie.jl</a></li>
<li><a class="menu-level-2" href="/recipe_df"><b>6.10</b> A Makie recipe for a Da..</a></li>
<li><a class="menu-level-1" href="/aog"><b>7</b> Data Visualization with Al..</a></li>
<li><a class="menu-level-2" href="/aog_layers"><b>7.1</b> Layers</a></li>
<li><a class="menu-level-2" href="/aog_layouts"><b>7.2</b> Layouts</a></li>
<li><a class="menu-level-2" href="/aog_stats"><b>7.3</b> Statistical Visualizatio..</a></li>
<li><a class="menu-level-2" href="/aog_custom"><b>7.4</b> Plot Customizations</a></li>
<li><a class="menu-level-2" href="/aog_makie"><b>7.5</b> Makie.jl and AlgebraOfGr..</a></li>
<li><a class="menu-level-1" href="/appendix"><b>8</b> Appendix</a></li>
<li><a class="menu-level-2" href="/appendix_pkg"><b>8.1</b> Packages Versions</a></li>
<li><a class="menu-level-2" href="/notation"><b>8.2</b> Notation</a></li>
<li><a class="menu-level-1" href="/references"><b></b> References</a></li>
</div>
</aside>

<div class="books-content">
<h1 data-number="4" id="sec:dataframes"><span class="header-section-number">4</span> DataFrames.jl</h1>
<p>Data comes mostly in a tabular format. By tabular, we mean that the data consists of a table containing rows and columns. Entries within any one column are usually of the same data type, whereas entries within a given row typically have different types. The rows, in practice, denote observations while columns denote variables. For example, we can have a table of TV shows containing the country in which each was produced and our personal rating, see Table <a href="#tbl:TV_shows">1</a>.</p>
<div id="tbl:TV_shows">
<table>
<caption>Table 1: TV shows.</caption>
<thead>
<tr>
<th style="text-align: right;">name</th>
<th style="text-align: right;">country</th>
<th style="text-align: right;">rating</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">Game of Thrones</td>
<td style="text-align: right;">United States</td>
<td style="text-align: right;">8.2</td>
</tr>
<tr>
<td style="text-align: right;">The Crown</td>
<td style="text-align: right;">England</td>
<td style="text-align: right;">7.3</td>
</tr>
<tr>
<td style="text-align: right;">Friends</td>
<td style="text-align: right;">United States</td>
<td style="text-align: right;">7.8</td>
</tr>
<tr>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
</tbody>
</table>
</div>
<p>Here, the dots mean that this could be a very long table and we only show a few rows. While analyzing data, often we come up with interesting questions about the data, also known as <em>data queries</em>. For large tables, computers would be able to answer these kinds of questions much quicker than you could do it by hand. Some examples of these so-called <em>queries</em> for this data could be:</p>
<ul>
<li>Which TV show has the highest rating?</li>
<li>Which TV shows were produced in the United States?</li>
<li>Which TV shows were produced in the same country?</li>
</ul>
<p>But, as a researcher, real science often starts with having multiple tables or data sources. For example, if we also have data from someone else’s ratings for the TV shows (Table <a href="#tbl:ratings">2</a>):</p>
<div id="tbl:ratings">
<table>
<caption>Table 2: Ratings.</caption>
<thead>
<tr>
<th style="text-align: right;">name</th>
<th style="text-align: right;">rating</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">Game of Thrones</td>
<td style="text-align: right;">7</td>
</tr>
<tr>
<td style="text-align: right;">Friends</td>
<td style="text-align: right;">6.4</td>
</tr>
<tr>
<td style="text-align: right;">…</td>
<td style="text-align: right;">…</td>
</tr>
</tbody>
</table>
</div>
<p>Now, questions that we could ask ourselves could be:</p>
<ul>
<li>What is Game of Thrones’ average rating?</li>
<li>Who gave the highest rating for Friends?</li>
<li>What TV shows were rated by you but not by the other person?</li>
</ul>
<p>In the rest of this chapter, we will show you how you can easily answer these questions in Julia. To do so, we first show why we need a Julia package called <code>DataFrames.jl</code>. In the next sections, we show how you can use this package and, finally, we show how to write fast data transformations (Section <a href="/df_performance#sec:df_performance">4.10</a>).</p>
<blockquote>
<p><strong><em>NOTE:</em></strong> <code>DataFrames.jl</code> has some <a href="https://bkamins.github.io/julialang/2021/05/14/nrow.html">guiding principles</a>. Notably, we would like to highlight two of them:</p>
<ol type="1">
<li>Stay <strong>consistent with Julia’s <code>Base</code></strong> module functions.</li>
<li><strong>Minimize the number of functions</strong> <code>DataFrames.jl</code> provides.</li>
</ol>
<p>Those two principles are really powerful because if you have a good grasp of Julia’s basic functions, such as <code>filter</code>, then you can do powerful operations on tabular data.</p>
<p>This is a benefit over Python’s <code>pandas</code> or R’s <code>dplyr</code> which differ more from the core languages.</p>
</blockquote>
<p>Let’s look at a table of grades like the one in Table <a href="#tbl:grades_for_2020">3</a>:</p>
<div id="tbl:grades_for_2020">
<table>
<caption>Table 3: Grades for 2020.</caption>
<thead>
<tr>
<th style="text-align: right;">name</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr>
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr>
<td style="text-align: right;">Alice</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr>
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
</div>
<p>Here, the column name has type <code>string</code>, age has type <code>integer</code>, and grade has type <code>float</code>.</p>
<p>So far, this book has only handled Julia’s basics. These basics are great for many things, but not for tables. To show that we need more, lets try to store the tabular data in arrays:</p>
<pre class="language-julia"><code>function grades_array()
    name = [&quot;Bob&quot;, &quot;Sally&quot;, &quot;Alice&quot;, &quot;Hank&quot;]
    age = [17, 18, 20, 19]
    grade_2020 = [5.0, 1.0, 8.5, 4.0]
    (; name, age, grade_2020)
end</code></pre>
<p>Now, the data is stored in so-called column-major form, which is cumbersome when we want to get data from a row:</p>
<pre class="language-julia"><code>function second_row()
    name, age, grade_2020 = grades_array()
    i = 2
    row = (name[i], age[i], grade_2020[i])
end
JDS.second_row()</code></pre>
<pre class="output"><code>(&quot;Sally&quot;, 18, 1.0)</code></pre>
<p>Or, if you want to have the grade for Alice, you first need to figure out in what row Alice is:</p>
<pre class="language-julia"><code>function row_alice()
    names = grades_array().name
    i = findfirst(names .== &quot;Alice&quot;)
end
row_alice()</code></pre>
<pre class="output"><code>
3
</code></pre>
<p>and then we can get the value:</p>
<pre class="language-julia"><code>function value_alice()
    grades = grades_array().grade_2020
    i = row_alice()
    grades[i]
end
value_alice()</code></pre>
<pre class="output"><code>
8.5
</code></pre>
<p><code>DataFrames.jl</code> can easily solve these kinds of issues. You can start by loading <code>DataFrames.jl</code> with <code>using</code>:</p>
<pre><code>using DataFrames</code></pre>
<p>With <code>DataFrames.jl</code>, we can define a <code>DataFrame</code> to hold our tabular data:</p>
<pre class="language-julia"><code>names = [&quot;Sally&quot;, &quot;Bob&quot;, &quot;Alice&quot;, &quot;Hank&quot;]
grades = [1, 5, 8.5, 4]
df = DataFrame(; name=names, grade_2020=grades)</code></pre>
<table>
<thead>
<tr>
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr>
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr>
<td style="text-align: right;">Alice</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr>
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
<p>which gives us a variable <code>df</code> containing our data in table format.</p>
<blockquote>
<p><strong><em>NOTE:</em></strong> This works, but there is one thing that we need to change straight away. In this example, we defined the variables <code>name</code>, <code>grade_2020</code> and <code>df</code> in global scope. This means that these variables can be accessed and edited from anywhere. If we would continue writing the book like this, we would have a few hundred variables at the end of the book even though the data that we put into the variable <code>name</code> should only be accessed via <code>DataFrame</code>! The variables <code>name</code> and <code>grade_2020</code> were never meant to be kept for long! Now, imagine that we would change the contents of <code>grade_2020</code> a few times in this book. Given only the book as PDF, it would be near impossible to figure out the contents of the variable by the end.</p>
<p>We can solve this very easily by using functions.</p>
</blockquote>
<p>Let’s do the same thing as before but now in a function:</p>
<pre class="language-julia"><code>function grades_2020()
    name = [&quot;Sally&quot;, &quot;Bob&quot;, &quot;Alice&quot;, &quot;Hank&quot;]
    grade_2020 = [1, 5, 8.5, 4]
    DataFrame(; name, grade_2020)
end
grades_2020()</code></pre>
<div id="tbl:grades_2020">
<table>
<caption>Table 4: Grades 2020.</caption>
<thead>
<tr>
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr>
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr>
<td style="text-align: right;">Alice</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr>
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
</div>
<p>Note that <code>name</code> and <code>grade_2020</code> are destroyed after the function returns, that is, they are only available in the function. There are two other benefits of doing this. First, it is now clear to the reader where <code>name</code> and <code>grade_2020</code> belong to: they belong to the grades of 2020. Second, it is easy to determine what the output of <code>grades_2020()</code> would be at any point in the book. For example, we can now assign the data to a variable <code>df</code>:</p>
<pre class="language-julia"><code>df = grades_2020()</code></pre>
<table>
<thead>
<tr>
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr>
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr>
<td style="text-align: right;">Alice</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr>
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
<p>Change the contents of <code>df</code>:</p>
<pre class="language-julia"><code>df = DataFrame(name = [&quot;Malice&quot;], grade_2020 = [&quot;10&quot;])</code></pre>
<table>
<thead>
<tr>
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">Malice</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
<p>And still recover the original data back without any problem:</p>
<pre class="language-julia"><code>df = grades_2020()</code></pre>
<table>
<thead>
<tr>
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr>
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr>
<td style="text-align: right;">Alice</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr>
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
<p>Of course, this assumes that the function is not re-defined. We promise to not do that in this book, because it is a bad idea exactly for this reason. Instead of “changing” a function, we will make a new one and give it a clear name.</p>
<p>So, back to the <code>DataFrames</code> constructor. As you might have seen, the way to create one is simply to pass vectors as arguments into the <code>DataFrame</code> constructor. You can come up with any valid Julia vector and it will work <strong>as long as the vectors have the same length</strong>. Duplicates, Unicode symbols and any sort of numbers are fine:</p>
<pre class="language-julia"><code>DataFrame(σ = [&quot;a&quot;, &quot;a&quot;, &quot;a&quot;], δ = [π, π/2, π/3])</code></pre>
<table>
<thead>
<tr>
<th style="text-align: right;">σ</th>
<th style="text-align: right;">δ</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">a</td>
<td style="text-align: right;">3.141592653589793</td>
</tr>
<tr>
<td style="text-align: right;">a</td>
<td style="text-align: right;">1.5707963267948966</td>
</tr>
<tr>
<td style="text-align: right;">a</td>
<td style="text-align: right;">1.0471975511965976</td>
</tr>
</tbody>
</table>
<p>Typically, in your code, you would create a function which wraps around one or more <code>DataFrame</code>s’ functions. For example, we can make a function to get the grades for one or more <code>names</code>:</p>
<pre class="language-julia"><code>function grades_2020(names::Vector{Int})
    df = grades_2020()
    df[names, :]
end
JDS.grades_2020([3, 4])</code></pre>
<table>
<thead>
<tr>
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">Alice</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr>
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
<p>This way of using functions to wrap around basic functionality in programming languages and packages is quite common. Basically, you can think of Julia and <code>DataFrames.jl</code> as providers of building blocks. They provide very <strong>generic</strong> building blocks which allow you to build things for your <strong>specific</strong> use case like this grades example. By using the blocks, you can make a data analysis script, control a robot or whatever you like to build.</p>
<p>So far, the examples were quite cumbersome, because we had to use indexes. In the next sections, we will show how to load and save data, and many powerful building blocks provided by <code>DataFrames.jl</code>.</p>


<div class="bottom-nav">
    <p id="nav-prev" style="text-align: left;">
        <a class="menu-level-2" href="/standardlibrary"><b>3.5</b> Julia Standard Library</a> <kbd>←</kbd>
        <span id="nav-next" style="float: right;">
            <kbd>→</kbd> <a class="menu-level-2" href="/load_save"><b>4.1</b> Load and Save Files</a>
        </span>
    </p>
</div>


<div class="license">
    <br/>
  <br/>
  <span style="display: flex; justify-content: center;"> <a
      style="display: flex; align-items: center; border: 1.5px solid black; border-radius: 10px;"
      href="https://opencollective.com/juliadatascience" target="_blank"> <img src="/images/coffee.png" height="18px" style="margin: 5px; display:inline"> <span style="margin-left: 4px; color: black !important">Support this project</span> </a> </span> <br> <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
    Jose Storopoli, Rik Huijzer, Lazaro Alonso
</div>
</div>
</div>
</body>
</html>