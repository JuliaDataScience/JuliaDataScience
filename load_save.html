<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jose Storopoli" />
  <meta name="author" content="Rik Huijzer" />
  <meta name="author" content="Lazaro Alonso" />
  <title>Load and Save Files - Julia Data Science</title>
  <link rel="shortcut icon" type="image/png" href="/favicon.png"/>
  <link rel="stylesheet" href="/style.css"/>
    <script src="/mousetrap.min.js"></script>
    <style>
  @font-face {
    font-family: JuliaMono-Regular;
    src: url("/JuliaMono-Regular.woff2");
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <link rel="stylesheet" href="/github.min.css">
<script src="/highlight.min.js"></script>
<script src="/julia.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
        if (!el.classList.contains('output')) {
            hljs.highlightElement(el);
        }
    });
});
</script>
 
</head>
<body>
<script>
function click_next() {
  var next = document.getElementById('nav-next');
  next.firstElementChild.nextElementSibling.click();
}
function click_prev() {
  var prev = document.getElementById('nav-prev');
  prev.firstElementChild.click();
}
Mousetrap.bind('right', click_next);
Mousetrap.bind('h', click_prev);
Mousetrap.bind('left', click_prev);
Mousetrap.bind('l', click_next);
</script>

<div class="books-container">
<aside class="books-menu">
<input type="checkbox" id="menu">
<label for="menu">☰</label>
<div class="books-title">
<a href="/">Julia Data Science</a>
</div><br />
<span class="books-subtitle">

</span>
<div class="books-menu-content">
<li><a class="menu-level-1" href="/preface"><b>1</b> Preface</a></li>
<li><a class="menu-level-2" href="/why_data_science"><b>1.1</b> What is Data Science?</a></li>
<li><a class="menu-level-2" href="/engineering"><b>1.2</b> Software Engineering</a></li>
<li><a class="menu-level-2" href="/acknowledgements"><b>1.3</b> Acknowledgements</a></li>
<li><a class="menu-level-1" href="/why_julia"><b>2</b> Why Julia?</a></li>
<li><a class="menu-level-2" href="/non-programmers"><b>2.1</b> For Non-Programmers</a></li>
<li><a class="menu-level-2" href="/programmers"><b>2.2</b> For Programmers</a></li>
<li><a class="menu-level-2" href="/julia_accomplish"><b>2.3</b> What Julia Aims to Accom..</a></li>
<li><a class="menu-level-2" href="/julia_wild"><b>2.4</b> Julia in the Wild</a></li>
<li><a class="menu-level-1" href="/julia_basics"><b>3</b> Julia Basics</a></li>
<li><a class="menu-level-2" href="/ide"><b>3.1</b> Development Environments</a></li>
<li><a class="menu-level-2" href="/syntax"><b>3.2</b> Language Syntax</a></li>
<li><a class="menu-level-2" href="/data_structures"><b>3.3</b> Native Data Structures</a></li>
<li><a class="menu-level-2" href="/filesystem"><b>3.4</b> Filesystem</a></li>
<li><a class="menu-level-2" href="/standardlibrary"><b>3.5</b> Julia Standard Library</a></li>
<li><a class="menu-level-1" href="/dataframes"><b>4</b> DataFrames.jl</a></li>
<li><a class="menu-level-2" href="/load_save"><b>4.1</b> Load and Save Files</a></li>
<li><a class="menu-level-2" href="/index-and-summarize"><b>4.2</b> Index and Summarize</a></li>
<li><a class="menu-level-2" href="/filter_subset"><b>4.3</b> Filter and Subset</a></li>
<li><a class="menu-level-2" href="/select"><b>4.4</b> Select</a></li>
<li><a class="menu-level-2" href="/types"><b>4.5</b> Types and Categorical Da..</a></li>
<li><a class="menu-level-2" href="/join"><b>4.6</b> Join</a></li>
<li><a class="menu-level-2" href="/transform"><b>4.7</b> Variable Transformations</a></li>
<li><a class="menu-level-2" href="/groupby_combine"><b>4.8</b> Groupby and Combine</a></li>
<li><a class="menu-level-2" href="/missing"><b>4.9</b> Missing Data</a></li>
<li><a class="menu-level-2" href="/df_performance"><b>4.10</b> Performance</a></li>
<li><a class="menu-level-1" href="/dataframesmeta"><b>5</b> DataFramesMeta.jl</a></li>
<li><a class="menu-level-2" href="/dataframesmeta_macros"><b>5.1</b> Macros</a></li>
<li><a class="menu-level-2" href="/dataframesmeta_select"><b>5.2</b> Column Selection</a></li>
<li><a class="menu-level-2" href="/dataframesmeta_transform"><b>5.3</b> Column Transformation</a></li>
<li><a class="menu-level-2" href="/dataframesmeta_subset"><b>5.4</b> Row Selection</a></li>
<li><a class="menu-level-2" href="/dataframesmeta_orderby"><b>5.5</b> Row Sorting</a></li>
<li><a class="menu-level-2" href="/dataframesmeta_combine"><b>5.6</b> Data Summaries</a></li>
<li><a class="menu-level-2" href="/dataframesmeta_chain"><b>5.7</b> Piping Operations</a></li>
<li><a class="menu-level-1" href="/DataVisualizationMakie"><b>6</b> Data Visualization with Ma..</a></li>
<li><a class="menu-level-2" href="/cairomakie"><b>6.1</b> CairoMakie.jl</a></li>
<li><a class="menu-level-2" href="/datavisMakie_attributes"><b>6.2</b> Attributes</a></li>
<li><a class="menu-level-2" href="/datavisMakie_create_Figure"><b>6.3</b> Create Plot Figure</a></li>
<li><a class="menu-level-2" href="/makie_cheat_sheets"><b>6.4</b> Cheat Sheets</a></li>
<li><a class="menu-level-2" href="/themes"><b>6.5</b> Themes</a></li>
<li><a class="menu-level-2" href="/using-latexstrings.jl"><b>6.6</b> Using LaTeXStrings.jl</a></li>
<li><a class="menu-level-2" href="/makie_colors"><b>6.7</b> Colors and Colormaps</a></li>
<li><a class="menu-level-2" href="/makie_layouts"><b>6.8</b> Layouts</a></li>
<li><a class="menu-level-2" href="/glmakie"><b>6.9</b> GLMakie.jl</a></li>
<li><a class="menu-level-2" href="/recipe_df"><b>6.10</b> A Makie recipe for a Da..</a></li>
<li><a class="menu-level-1" href="/aog"><b>7</b> Data Visualization with Al..</a></li>
<li><a class="menu-level-2" href="/aog_layers"><b>7.1</b> Layers</a></li>
<li><a class="menu-level-2" href="/aog_layouts"><b>7.2</b> Layouts</a></li>
<li><a class="menu-level-2" href="/aog_stats"><b>7.3</b> Statistical Visualizatio..</a></li>
<li><a class="menu-level-2" href="/aog_custom"><b>7.4</b> Plot Customizations</a></li>
<li><a class="menu-level-2" href="/aog_makie"><b>7.5</b> Makie.jl and AlgebraOfGr..</a></li>
<li><a class="menu-level-1" href="/appendix"><b>8</b> Appendix</a></li>
<li><a class="menu-level-2" href="/appendix_pkg"><b>8.1</b> Packages Versions</a></li>
<li><a class="menu-level-2" href="/notation"><b>8.2</b> Notation</a></li>
<li><a class="menu-level-1" href="/references"><b></b> References</a></li>
</div>
</aside>

<div class="books-content">
<h2 data-number="4.1" id="sec:load_save"><span class="header-section-number">4.1</span> Load and Save Files</h2>
<p>Having only data inside Julia programs and not being able to load or save it would be very limiting. Therefore, we start by mentioning how to store files to and load files from disk. We focus on CSV, see Section <a href="/load_save#sec:csv">4.1.1</a>, and Excel, see Section <a href="/load_save#sec:excel">4.1.2</a>, file formats since those are the most common data storage formats for tabular data.</p>
<h3 data-number="4.1.1" id="sec:csv"><span class="header-section-number">4.1.1</span> CSV</h3>
<p><strong>C</strong>omma-<strong>s</strong>eparated <strong>v</strong>alues (CSV) files are are very effective way to store tables. CSV files have two advantages over other data storage files. First, it does exactly what the name indicates it does, namely storing values by separating them using commas <code>,</code>. This acronym is also used as the file extension. So, be sure that you save your files using the “.csv” extension such as “myfile.csv”. To demonstrate how a CSV file looks, we can add the <a href="http://csv.juliadata.org/latest/"><code>CSV.jl</code></a> package using the <code>Pkg</code> REPL mode (Section <a href="/standardlibrary#sec:project_management_creating">3.5.4.2</a>):</p>
<pre class="julia-repl"><code>julia&gt; ]

pkg&gt; add CSV</code></pre>
<p>and load it via:</p>
<pre class="julia"><code>using CSV</code></pre>
<p>We can now use our previous data:</p>
<pre class="language-julia"><code>grades_2020()</code></pre>
<table>
<thead>
<tr>
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr>
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr>
<td style="text-align: right;">Alice</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr>
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
<p>and read it from a file after writing it:</p>
<pre class="language-julia"><code>function write_grades_csv()
    path = &quot;grades.csv&quot;
    CSV.write(path, grades_2020())
end</code></pre>
<pre class="language-julia"><code>path = write_grades_csv()
read(path, String)</code></pre>
<pre class="output"><code>name,grade_2020
Sally,1.0
Bob,5.0
Alice,8.5
Hank,4.0
</code></pre>
<p>Here, we also see the second benefit of CSV data format: the data can be read by using a simple text editor. This differs from many alternative data formats which require proprietary software, e.g. Excel.</p>
<p>This works wonders, but what if our data <strong>contains commas <code>,</code></strong> as values? If we were to naively write data with commas, it would make the files very hard to convert back to a table. Luckily, <code>CSV.jl</code> handles this for us automatically. Consider the following data with commas <code>,</code>:</p>
<pre class="language-julia"><code>function grades_with_commas()
    df = grades_2020()
    df[3, :name] = &quot;Alice,&quot;
    df
end
grades_with_commas()</code></pre>
<div id="tbl:grades_with_commas">
<table>
<caption>Table 5: Grades with commas.</caption>
<thead>
<tr>
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr>
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr>
<td style="text-align: right;">Alice,</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr>
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
</div>
<p>If we write this, we get:</p>
<pre class="language-julia"><code>function write_comma_csv()
    path = &quot;grades-commas.csv&quot;
    CSV.write(path, grades_with_commas())
end
path = write_comma_csv()
read(path, String)</code></pre>
<pre class="output"><code>name,grade_2020
Sally,1.0
Bob,5.0
&quot;Alice,&quot;,8.5
Hank,4.0
</code></pre>
<p>So, <code>CSV.jl</code> adds quotation marks <code>"</code> around the comma-containing values. Another common way to solve this problem is to write the data to a <strong>t</strong>ab-<strong>s</strong>eparated <strong>v</strong>alues (TSV) file format. This assumes that the data doesn’t contain tabs, which holds in most cases.</p>
<p>Also, note that TSV files can also be read using a simple text editor, and these files use the “.tsv” extension.</p>
<pre class="language-julia"><code>function write_comma_tsv()
    path = &quot;grades-comma.tsv&quot;
    CSV.write(path, grades_with_commas(); delim=&#39;\t&#39;)
end
read(write_comma_tsv(), String)</code></pre>
<pre class="output"><code>name    grade_2020
Sally   1.0
Bob 5.0
Alice,  8.5
Hank    4.0
</code></pre>
<p>Text file formats like CSV and TSV files can also be found that use other delimiters, such as semicolons “;”, spaces “ ”, or even something as unusual as “π”.</p>
<pre class="language-julia"><code>function write_space_separated()
    path = &quot;grades-space-separated.csv&quot;
    CSV.write(path, grades_2020(); delim=&#39; &#39;)
end
read(write_space_separated(), String)</code></pre>
<pre class="output"><code>name grade_2020
Sally 1.0
Bob 5.0
Alice 8.5
Hank 4.0
</code></pre>
<p>By convention, it’s still best to give files with special delimiters, such as “;”, the “.csv” extension.</p>
<p>Loading CSV files using <code>CSV.jl</code> is done in a similar way. You can use <code>CSV.read</code> and specify in what kind of format you want the output. We specify a <code>DataFrame</code>.</p>
<pre class="language-julia"><code>path = write_grades_csv()
CSV.read(path, DataFrame)</code></pre>
<table>
<thead>
<tr>
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr>
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr>
<td style="text-align: right;">Alice</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr>
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
<p>Conveniently, <code>CSV.jl</code> will automatically infer column types for us:</p>
<pre class="language-julia"><code>path = write_grades_csv()
df = CSV.read(path, DataFrame)</code></pre>
<pre class="output"><code>4×2 DataFrame
 Row │ name     grade_2020
     │ String7  Float64
─────┼─────────────────────
   1 │ Sally           1.0
   2 │ Bob             5.0
   3 │ Alice           8.5
   4 │ Hank            4.0</code></pre>
<p>It works even for far more complex data:</p>
<pre class="language-julia"><code>my_data = &quot;&quot;&quot;
    a,b,c,d,e
    Kim,2018-02-03,3,4.0,2018-02-03T10:00
    &quot;&quot;&quot;
path = &quot;my_data.csv&quot;
write(path, my_data)
df = CSV.read(path, DataFrame)</code></pre>
<pre class="output"><code>1×5 DataFrame
 Row │ a        b           c      d        e
     │ String3  Date        Int64  Float64  DateTime
─────┼──────────────────────────────────────────────────────────
   1 │ Kim      2018-02-03      3      4.0  2018-02-03T10:00:00</code></pre>
<p>These CSV basics should cover most use cases. For more information, see the <a href="https://csv.juliadata.org/stable"><code>CSV.jl</code> documentation</a> and especially the <a href="https://csv.juliadata.org/stable/#CSV.File"><code>CSV.File</code> constructor docstring</a>.</p>
<h3 data-number="4.1.2" id="sec:excel"><span class="header-section-number">4.1.2</span> Excel</h3>
<p>There are multiple Julia packages to read Excel files. In this book, we will only look at <a href="https://github.com/felipenoris/XLSX.jl"><code>XLSX.jl</code></a>, because it is the most actively maintained package in the Julia ecosystem that deals with Excel data. As a second benefit, <code>XLSX.jl</code> is written in pure Julia, which makes it easy for us to inspect and understand what’s going on under the hood.</p>
<p>Load <code>XLSX.jl</code> via</p>
<pre><code>using XLSX:
    eachtablerow,
    readxlsx,
    writetable</code></pre>
<p>To write files, we define a little helper function for data and column names:</p>
<pre class="language-julia"><code>function write_xlsx(name, df::DataFrame)
    path = &quot;$name.xlsx&quot;
    data = collect(eachcol(df))
    cols = names(df)
    writetable(path, data, cols)
end</code></pre>
<p>Now, we can easily write the grades to an Excel file:</p>
<pre class="language-julia"><code>function write_grades_xlsx()
    path = &quot;grades&quot;
    write_xlsx(path, grades_2020())
    &quot;$path.xlsx&quot;
end</code></pre>
<p>When reading it back, we will see that <code>XLSX.jl</code> puts the data in a <code>XLSXFile</code> type and we can access the desired <code>sheet</code> much like a <code>Dict</code>:</p>
<pre class="language-julia"><code>path = write_grades_xlsx()
xf = readxlsx(path)</code></pre>
<pre class="output"><code>XLSXFile(&quot;grades.xlsx&quot;) containing 1 Worksheet
            sheetname size          range        
-------------------------------------------------
               Sheet1 5x2           A1:B5        
</code></pre>
<pre class="language-julia"><code>xf = readxlsx(write_grades_xlsx())
sheet = xf[&quot;Sheet1&quot;]
eachtablerow(sheet) |&gt; DataFrame</code></pre>
<table>
<thead>
<tr>
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr>
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr>
<td style="text-align: right;">Alice</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr>
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
<p>Notice that we cover just the basics of <code>XLSX.jl</code> but more powerful usage and customizations are available. For more information and options, see the <a href="https://felipenoris.github.io/XLSX.jl/stable/"><code>XLSX.jl</code> documentation</a>.</p>


<div class="bottom-nav">
    <p id="nav-prev" style="text-align: left;">
        <a class="menu-level-1" href="/dataframes"><b>4</b> DataFrames.jl</a> <kbd>←</kbd>
        <span id="nav-next" style="float: right;">
            <kbd>→</kbd> <a class="menu-level-2" href="/index-and-summarize"><b>4.2</b> Index and Summarize</a>
        </span>
    </p>
</div>


<div class="license">
    <br/>
  <br/>
  <span style="display: flex; justify-content: center;"> <a
      style="display: flex; align-items: center; border: 1.5px solid black; border-radius: 10px;"
      href="https://opencollective.com/juliadatascience" target="_blank"> <img src="/images/coffee.png" height="18px" style="margin: 5px; display:inline"> <span style="margin-left: 4px; color: black !important">Support this project</span> </a> </span> <br> <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
    Jose Storopoli, Rik Huijzer, Lazaro Alonso
</div>
</div>
</div>
</body>
</html>