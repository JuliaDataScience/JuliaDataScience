<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jose Storopoli" />
  <meta name="author" content="Rik Huijzer" />
  <meta name="author" content="Lazaro Alonso" />
  <title>Carregar e salvar arquivos - Julia Data Science</title>
  <link rel="shortcut icon" type="image/png" href="/pt/favicon.png"/>
  <link rel="stylesheet" href="/pt/style.css"/>
    <script src="/pt/mousetrap.min.js"></script>
    <style>
  @font-face {
    font-family: JuliaMono-Regular;
    src: url("/pt/JuliaMono-Regular.woff2");
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <link rel="stylesheet" href="/pt/github.min.css">
<script src="/pt/highlight.min.js"></script>
<script src="/pt/julia.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
        hljs.highlightElement(el);
    });
});
</script>
 
</head>
<body>
<script>
function click_next() {
  var next = document.getElementById('nav-next');
  next.firstElementChild.nextElementSibling.click();
}
function click_prev() {
  var prev = document.getElementById('nav-prev');
  prev.firstElementChild.click();
}
Mousetrap.bind('right', click_next);
Mousetrap.bind('h', click_prev);
Mousetrap.bind('left', click_prev);
Mousetrap.bind('l', click_next);
</script>

<div class="books-container">
<aside class="books-menu">
<input type="checkbox" id="menu">
<label for="menu">☰</label>
<div class="books-title">
<a href="/pt/">Julia Data Science</a>
</div><br />
<span class="books-subtitle">

</span>
<div class="books-menu-content">
<li><a class="menu-level-1" href="/pt/preface"><b>1</b> Prefácio</a></li>
<li><a class="menu-level-2" href="/pt/why_data_science"><b>1.1</b> O que é Ciência de Dad..</a></li>
<li><a class="menu-level-2" href="/pt/engineering"><b>1.2</b> Engenharia de software</a></li>
<li><a class="menu-level-2" href="/pt/agradecimentos"><b>1.3</b> Agradecimentos</a></li>
<li><a class="menu-level-1" href="/pt/why_julia"><b>2</b> Por que Julia?</a></li>
<li><a class="menu-level-2" href="/pt/non-programmers"><b>2.1</b> Para os que nunca progra..</a></li>
<li><a class="menu-level-2" href="/pt/programmers"><b>2.2</b> Para programadores</a></li>
<li><a class="menu-level-2" href="/pt/julia_accomplish"><b>2.3</b> O que Julia pretende alc..</a></li>
<li><a class="menu-level-2" href="/pt/julia_wild"><b>2.4</b> Julia Por Aí</a></li>
<li><a class="menu-level-1" href="/pt/julia_basics"><b>3</b> Básico de Julia</a></li>
<li><a class="menu-level-2" href="/pt/syntax"><b>3.1</b> Sintaxe da linguagem</a></li>
<li><a class="menu-level-2" href="/pt/data_structures"><b>3.2</b> Estruturas Nativas de Da..</a></li>
<li><a class="menu-level-2" href="/pt/filesystem"><b>3.3</b> Sistema de Arquivos</a></li>
<li><a class="menu-level-2" href="/pt/standardlibrary"><b>3.4</b> Biblioteca Padrão de Ju..</a></li>
<li><a class="menu-level-1" href="/pt/dataframes"><b>4</b> DataFrames.jl</a></li>
<li><a class="menu-level-2" href="/pt/load_save"><b>4.1</b> Carregar e salvar arquiv..</a></li>
<li><a class="menu-level-2" href="/pt/indexação-e-sumarização"><b>4.2</b> Indexação e Sumarização</a></li>
<li><a class="menu-level-2" href="/pt/filter_subset"><b>4.3</b> Filtro e Subconjunto</a></li>
<li><a class="menu-level-2" href="/pt/select"><b>4.4</b> Select</a></li>
<li><a class="menu-level-2" href="/pt/missing_data"><b>4.5</b> Tipos de Dados e Dados F..</a></li>
<li><a class="menu-level-2" href="/pt/join"><b>4.6</b> Join</a></li>
<li><a class="menu-level-2" href="/pt/transformações-de-variáveis"><b>4.7</b> Transformações de Vari..</a></li>
<li><a class="menu-level-2" href="/pt/groupby_combine"><b>4.8</b> Groupby e Combine</a></li>
<li><a class="menu-level-2" href="/pt/df_performance"><b>4.9</b> Desempenho</a></li>
<li><a class="menu-level-1" href="/pt/DataVisualizationMakie"><b>5</b> Visualização de dados co..</a></li>
<li><a class="menu-level-2" href="/pt/cairomakie"><b>5.1</b> CairoMakie.jl</a></li>
<li><a class="menu-level-2" href="/pt/datavisMakie_attributes"><b>5.2</b> Atributos</a></li>
<li><a class="menu-level-2" href="/pt/themes"><b>5.3</b> Temas</a></li>
<li><a class="menu-level-2" href="/pt/usando-latexstrings.jl"><b>5.4</b> Usando LaTeXStrings.jl</a></li>
<li><a class="menu-level-2" href="/pt/makie_colors"><b>5.5</b> Cores e mapas de cores</a></li>
<li><a class="menu-level-2" href="/pt/makie_layouts"><b>5.6</b> Layouts</a></li>
<li><a class="menu-level-2" href="/pt/glmakie"><b>5.7</b> GLMakie.jl</a></li>
<li><a class="menu-level-1" href="/pt/appendix"><b>6</b> Apêndice</a></li>
<li><a class="menu-level-2" href="/pt/appendix_pkg"><b>6.1</b> Versões dos Pacotes</a></li>
<li><a class="menu-level-2" href="/pt/notation"><b>6.2</b> Formatação</a></li>
<li><a class="menu-level-1" href="/pt/referências"><b></b> Referências</a></li>
</div>
</aside>

<div class="books-content">
<h2 data-number="4.1" id="sec:load_save"><span class="header-section-number">4.1</span> Carregar e salvar arquivos</h2>
<p>Ter os dados apenas dentro dos programas Julia e não ser capaz de carregá-los ou salvá-los seria muito limitante. Portanto, começamos mencionando como armazenar e carregar arquivos do HD. Focamos em formatos de arquivo CSV, veja Section <a href="/pt/load_save#sec:csv">4.1.1</a>, e Excel, veja Section <a href="/pt/load_save#sec:excel">4.1.2</a>, uma vez que esses são os formatos de armazenamento de dados mais comuns para dados tabulares.</p>
<h3 data-number="4.1.1" id="sec:csv"><span class="header-section-number">4.1.1</span> CSV</h3>
<p>Arquivos <strong>C</strong>omma-<strong>s</strong>eparated <strong>v</strong>alues (CSV, valores separados por vírgula) são eficazes no armazenamento de tabelas. Os arquivos CSV têm duas vantagens sobre outros arquivos de armazenamento de dados. Primeiro, eles fazem exatamente o que o nome indica que fazem, ou seja, armazenam valores, separando-os por vírgulas <code>,</code> (ou, em sistemas operacionais ambientados no Brasil, separados por ponto-e-vírgula, pois a vírgula é utilizada como separador decimal). Este acrônimo também é usado como extensão de arquivo. Portanto, certifique-se de salvar seus arquivos usando a extensão “.csv” tal como “myfile.csv.” Para demonstrar a aparência de um arquivo CSV, podemos instalar o pacote <a href="http://csv.juliadata.org/latest/"><code>CSV.jl</code></a>:</p>
<pre><code>julia&gt; ]

pkg&gt; add CSV</code></pre>
<p>e carregá-lo via:</p>
<pre><code>using CSV</code></pre>
<p>Agora podemos usar nossos dados anteriores:</p>
<pre class="language-julia"><code>grades_2020()</code></pre>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Alice</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
<p>e escrevê-los em um arquivo, para em seguida lê-los novamente:</p>
<pre class="language-julia"><code>function write_grades_csv()
    path = &quot;grades.csv&quot;
    CSV.write(path, grades_2020())
end</code></pre>
<pre class="language-julia"><code>path = write_grades_csv()
read(path, String)</code></pre>
<pre class="output"><code>name,grade_2020
Sally,1.0
Bob,5.0
Alice,8.5
Hank,4.0
</code></pre>
<p>Aqui, também vemos o segundo benefício do formato de dados CSV: os dados podem ser lidos usando um editor de texto simples. Isso difere de muitos formatos de dados alternativos que requerem software proprietário, por exemplo, Excel.</p>
<p>Isso funciona muito bem, mas e se nossos dados <strong>contiverem vírgulas <code>,</code></strong> como valores? Se tivéssemos de escrever ingenuamente os dados com vírgulas, isso tornaria os arquivos muito difíceis de se converter de volta para uma tabela. Por sorte, <code>CSV.jl</code> resolve esse problema para nós de forma automática. Considere os seguintes dados com vírgulas <code>,</code>:</p>
<pre class="language-julia"><code>function grades_with_commas()
    df = grades_2020()
    df[3, :name] = &quot;Alice,&quot;
    df
end
grades_with_commas()</code></pre>
<div id="tbl:grades_with_commas">
<table>
<caption>Table 5: Grades with commas.</caption>
<thead>
<tr class="header">
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Alice,</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
</div>
<p>Se escrevermos isso, teremos:</p>
<pre class="language-julia"><code>function write_comma_csv()
    path = &quot;grades-commas.csv&quot;
    CSV.write(path, grades_with_commas())
end
path = write_comma_csv()
read(path, String)</code></pre>
<pre class="output"><code>name,grade_2020
Sally,1.0
Bob,5.0
&quot;Alice,&quot;,8.5
Hank,4.0
</code></pre>
<p>Logo, <code>CSV.jl</code> adiciona aspas <code>"</code> em torno dos valores contendo vírgulas. Outra maneira comum de resolver esse problema é gravar os dados em um formato de arquivo <strong>t</strong>ab-<strong>s</strong>eparated <strong>v</strong>alues (TSV, valores separados por tabulações). Isso pressupõe que os dados não contêm tabulações, o que é válido na maioria dos casos.</p>
<p>Além disso, observe que os arquivos TSV também podem ser lidos usando um editor de texto simples e esses arquivos usam a extensão “.tsv.”</p>
<pre class="language-julia"><code>function write_comma_tsv()
    path = &quot;grades-comma.tsv&quot;
    CSV.write(path, grades_with_commas(); delim=&#39;\t&#39;)
end
read(write_comma_tsv(), String)</code></pre>
<pre class="output"><code>name    grade_2020
Sally   1.0
Bob 5.0
Alice,  8.5
Hank    4.0
</code></pre>
<p>Também é possível encontrar formatos de arquivo de texto, como arquivos CSV e TSV, que usam outros delimitadores, como ponto-e-vírgula “;” espaços “ ,” ou mesmo algo tão incomum como “π.”</p>
<pre class="language-julia"><code>function write_space_separated()
    path = &quot;grades-space-separated.csv&quot;
    CSV.write(path, grades_2020(); delim=&#39; &#39;)
end
read(write_space_separated(), String)</code></pre>
<pre class="output"><code>name grade_2020
Sally 1.0
Bob 5.0
Alice 8.5
Hank 4.0
</code></pre>
<p>Por convenção, ainda assim é melhor dar a extensão “.csv” a arquivos com delimitadores especiais, como “;”</p>
<p>O carregamento de arquivos CSV usando <code>CSV.jl</code> é feito de maneira semelhante. Você pode usar <code>CSV.read</code> e especificar qual o formato do retorno da função. Nós especificamos um <code>DataFrame</code>.</p>
<pre class="language-julia"><code>path = write_grades_csv()
CSV.read(path, DataFrame)</code></pre>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Alice</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
<p>Convenientemente, <code>CSV.jl</code> irá inferir automaticamente os tipos de dados das colunas para nós:</p>
<pre class="language-julia"><code>path = write_grades_csv()
df = CSV.read(path, DataFrame)</code></pre>
<pre class="output"><code>4×2 DataFrame
 Row │ name     grade_2020
     │ String7  Float64
─────┼─────────────────────
   1 │ Sally           1.0
   2 │ Bob             5.0
   3 │ Alice           8.5
   4 │ Hank            4.0</code></pre>
<p>Funciona mesmo com dados muito mais complexos:</p>
<pre class="language-julia"><code>my_data = &quot;&quot;&quot;
    a,b,c,d,e
    Kim,2018-02-03,3,4.0,2018-02-03T10:00
    &quot;&quot;&quot;
path = &quot;my_data.csv&quot;
write(path, my_data)
df = CSV.read(path, DataFrame)</code></pre>
<pre class="output"><code>1×5 DataFrame
 Row │ a        b           c      d        e
     │ String3  Date        Int64  Float64  DateTime
─────┼──────────────────────────────────────────────────────────
   1 │ Kim      2018-02-03      3      4.0  2018-02-03T10:00:00</code></pre>
<p>Essas noções básicas de CSV devem abranger a maioria dos casos de uso. Para obter mais informações, consulte a <a href="https://csv.juliadata.org/stable">documentação do <code>CSV.jl</code></a> e, especialemnte, o <a href="https://csv.juliadata.org/stable/#CSV.File">docstring do construtor <code>CSV.File</code></a>.</p>
<h3 data-number="4.1.2" id="sec:excel"><span class="header-section-number">4.1.2</span> Excel</h3>
<p>Existem vários pacotes Julia para ler arquivos Excel. Neste livro, nós vamos cobrir apenas o <a href="https://github.com/felipenoris/XLSX.jl"><code>XLSX.jl</code></a>, porque é o pacote mais ativamente mantido no ecossistema Julia que lida com dados do Excel. Como um segundo benefício, <code>XLSX.jl</code> é escrito em Julia puro, o que torna mais fácil para nós inspecionarmos e entendermos o que está acontecendo nos bastidores.</p>
<p>Carregue <code>XLSX.jl</code> via</p>
<pre><code>using XLSX:
    eachtablerow,
    readxlsx,
    writetable</code></pre>
<p>Para escrever arquivos, definimos uma pequena função auxiliar para dados e nomes de colunas:</p>
<pre class="language-julia"><code>function write_xlsx(name, df::DataFrame)
    path = &quot;$name.xlsx&quot;
    data = collect(eachcol(df))
    cols = names(df)
    writetable(path, data, cols)
end</code></pre>
<p>Agora, podemos escrever facilmente os dados das notas escolares em um arquivo Excel:</p>
<pre class="language-julia"><code>function write_grades_xlsx()
    path = &quot;grades&quot;
    write_xlsx(path, grades_2020())
    &quot;$path.xlsx&quot;
end</code></pre>
<p>Ao ler de volta, veremos que <code>XLSX.jl</code> coloca os dados em um tipo <code>XLSXFile</code> e podemos acessar a <code>aba</code> desejada como um <code>Dict</code>:</p>
<pre class="language-julia"><code>path = write_grades_xlsx()
xf = readxlsx(path)</code></pre>
<pre class="output"><code>XLSXFile(&quot;grades.xlsx&quot;) containing 1 Worksheet
            sheetname size          range        
-------------------------------------------------
               Sheet1 5x2           A1:B5        
</code></pre>
<pre class="language-julia"><code>xf = readxlsx(write_grades_xlsx())
sheet = xf[&quot;Sheet1&quot;]
eachtablerow(sheet) |&gt; DataFrame</code></pre>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">name</th>
<th style="text-align: right;">grade_2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Sally</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">Bob</td>
<td style="text-align: right;">5.0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Alice</td>
<td style="text-align: right;">8.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">Hank</td>
<td style="text-align: right;">4.0</td>
</tr>
</tbody>
</table>
<p>Observe que cobrimos apenas o básico de <code>XLSX.jl</code> mas usos mais poderosos e customizações estão disponíveis. Para obter mais informações e opções, consulte a <a href="https://felipenoris.github.io/XLSX.jl/stable/">documentação do módulo <code>XLSX.jl</code></a>.</p>


<div class="bottom-nav">
    <p id="nav-prev" style="text-align: left;">
        <a class="menu-level-1" href="/pt/dataframes"><b>4</b> DataFrames.jl</a> <kbd>←</kbd>
        <span id="nav-next" style="float: right;">
            <kbd>→</kbd> <a class="menu-level-2" href="/pt/indexação-e-sumarização"><b>4.2</b> Indexação e Sumarização</a>
        </span>
    </p>
</div>


<div class="license">
    <br/>
  <br/>
  <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
    Jose Storopoli, Rik Huijzer, Lazaro Alonso
</div>
</div>
</div>
</body>
</html>